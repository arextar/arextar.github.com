(function(e){function r(e){var t=document.createElement("iframe"),r=this.__queue=[],i=this;t.style.display="none",t.src=n.src.replace(/\/[^\/]+$/,"")+"/wrench.html",t.onload=function(){var n=document.createElement("script");n.src=location.href.replace(/\/[^\/]+$/,"")+e,t.contentDocument.body.appendChild(n),n.onreadystatechange=n.onload=function(){if(!n.readyState||n.readyState==="complete"||n.readyState==="done"){var e=i.__self=t.contentWindow.self,s=e.__queue;for(var o=0;o<r.length;o++)e.onmessage({data:r[o]});for(o=0;o<s.length;o++)i.onmessage({data:s[o]});e.postMessage=t.contentWindow.postMessage=function(e){i.onmessage({data:e})}}}},document.body.appendChild(t)}function o(e){var t=this;this.worker=e,this.events={},this.fns={},e.onmessage=function(e){t._handleMessage(e.data)}}function u(e,t){return function(){t.emit("__call",e,s.call(arguments))}}var t=window.wrench={init:function(t){return new o(new(e||r)(t))}},n=document.getElementsByTagName("script");n=n[n.length-1],r.prototype.postMessage=function(e){this.__self?this.__self.onmessage({data:e}):this.__queue.push(e)};var i=1,s=[].slice;o.prototype._decodeArgs=function(e){for(var t=0;t<e.length;t++)typeof e[t]=="string"&&/^__wrenchFunction/.test(e[t])&&(e[t]=u(e[t],this));return e},o.prototype._encodeArgs=function(e){for(var t=0;t<e.length;t++)if(typeof e[t]=="function"){var n="__wrenchFunction"+i++;this.fns[n]=e[t],e[t]=n}return e},o.prototype._handleMessage=function(e){typeof e=="string"&&(e=JSON.parse(e));if(e.type==="__call"){this.fns[e.args[0]].apply(this,e.args[1]);return}if(e.type==="__log"){window.console&&console.log.apply(console,e.args);return}var t=this.events[e.type];if(!t)return;var n=this._decodeArgs(e.args);if(typeof t=="function")return t.apply(this,n);for(var r=0;r<t.length;r++)t[r].apply(this,n)},o.prototype.emit=function(e,t,n){var r=arguments.length;this.worker.postMessage({type:e,args:r<2?[]:this._encodeArgs(r<3?[t]:r<4?[t,n]:s.call(arguments,1))})},o.prototype.on=function(e,t){var n=this.events,r=typeof n[e];r==="undefined"?n[e]=t:r==="function"?n[e]=[n[e],t]:n[e].push(t)},o.prototype.log=function(e,t){var n=arguments.length;this.worker.postMessage({type:"__log",args:n<1?[]:n<2?[e]:n<3?[e,t]:s.call(arguments)})}})(typeof Worker!="undefined"?Worker:!1),function(){function e(e){return document.getElementById(e)}function a(){for(var e=0,t;t=u[e++];)!t.src&&t.offsetTop+t.offsetHeight/2<scrollY+innerHeight&&(t.src=t.getAttribute("data-src"),t.removeAttribute("data-src"))}function f(){if(Math.random()<.05){var t=e("header").lastChild.lastChild;console.log(t);switch(0|Math.random()*10){case 1:t.className="author weird-spin",t.innerHTML="Wlex Ailson";break;case 2:t.className="author weird-flip";break;case 2:t.className="author weird-grow"}}}var t=e("search"),n=e("results"),r=t.firstChild,i=t.childNodes[1],s=wrench.init("/script/search.min.js"),o;i.style.visibility="hidden",s.on("populate",function(e){var t=document.createElement("div");t.className="result",t.innerHTML="<h4><a href=/post/"+e.id+".html>"+e.title+"</a></h4><p>"+e.snip+"...</p>",n.appendChild(t)}),s.on("done",function(){i.style.visibility="hidden"}),r.onkeyup=function(){r.value!==o&&r.value&&(i.style.visibility="",n.innerHTML="",s.emit("search",o=r.value))};var u=document.getElementsByTagName("img");setTimeout(function(){a(),window.onscroll=a,f()},100)}()